# Sourccey Robot Guide

This guide walks you through setting up and using the Sourccey robot, from initial calibration to teleoperation and data collection.

## Table of Contents

1. [Setup](#setup)
2. [Calibration](#calibration)
3. [Hosting the Robot](#hosting-the-robot)
4. [Teleoperation](#teleoperation)
5. [Recording Data](#recording-data)
6. [Training Models](#training-models)
7. [Evaluation](#evaluation)
8. [Utilities](#utilities)

---

## Setup

Before using the Sourccey robot, you need to set up the development environment. This includes installing dependencies and compiling protobuf files.

### Prerequisites

-   Python 3.10 or higher
-   [uv](https://docs.astral.sh/uv/getting-started/installation/) (Python package manager)
-   Git

### Installing uv

If you don't have `uv` installed, install it:

**On Linux/Mac:**
curl -LsSf https://astral.sh/uv/install.sh | sh**On Windows:**
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"**On Debian-based systems (like Raspberry Pi OS):**sh
sudo apt install python3-full python3-pip pipx
pipx install uv### Setting Up the Environment

1. **Create a virtual environment:**h
   uv venv
2. **Install LeRobot with Sourccey dependencies:**
   uv pip install -e ".[feetech,smolvla,sourccey]"This installs the project in editable mode with all required extras for the Sourccey robot.

3. **Compile Sourccey protobuf files:**sh
   uv run python src/lerobot/robots/sourccey/sourccey/protobuf/compile.pyAlternatively, you can use the function import method:h
   uv run python -c "from lerobot.robots.sourccey.sourccey.protobuf.compile import compile_sourccey_protobuf; compile_sourccey_protobuf()"### Activating the Virtual Environment

After setup, activate the virtual environment:

**On Linux/Mac:**
source .venv/bin/activate**On Windows:**sh
source .venv/Scripts/activate---

## Calibration

Before using the robot, you need to calibrate both the robot and the teleoperator.

### Robot Calibration

Calibrate the robot arms on the Raspberry Pi:

```
uv run src/lerobot/scripts/sourccey/auto_calibrate.py \
 --robot.type=sourccey \
 --robot.id=sourccey
```

For a hard reset (re-detects mechanical limits):

```
uv run src/lerobot/scripts/sourccey/auto_calibrate.py \
 --robot.type=sourccey \
 --robot.id=sourccey \
 --full_reset=True
```

### Teleoperator Calibration

Find the ports for your robot

```
python src/lerobot/scripts/lerobot_find_port.py
```

Then Calibrate the bi-manual teleoperator (leader arms):

```
python src/lerobot/scripts/sourccey/calibration/auto_calibrate.py \
 --teleop.type=bi_sourccey_leader \
 --teleop.id=bisd_sourccey_leader \
 --teleop.left_arm_port="COM20" \
 --teleop.right_arm_port="COM19"
```

python src/lerobot/control/sourccey/sourccey/teleoperate.py  --id="sourccey"  --remote_ip="192.168.1.211"  --left_arm_port="/dev/ttyACM1"  --right_arm_port="/dev/ttyACM0"  --keyboard_port="keyboard"  --fps=30  --reverse=True


For single-arm teleoperator:

```
python -m lerobot.calibrate \
 --teleop.type=sourccey_leader \
 --teleop.port=COM28 \
 --teleop.id=sourccey_leader
```

### Viewing/Editing Calibration Files

View calibration files:

```
cat ~/.cache/huggingface/lerobot/calibration/robots/sourccey_follower/sourccey_left.json
cat ~/.cache/huggingface/lerobot/calibration/robots/sourccey_follower/sourccey_right.json
cat ~/.cache/huggingface/lerobot/calibration/robots/sourccey_z_actuator/sourccey_z_actuator.json
```

Edit calibration files:

```
nano ~/.cache/huggingface/lerobot/calibration/robots/sourccey_follower/sourccey_left.json
nano ~/.cache/huggingface/lerobot/calibration/robots/sourccey_follower/sourccey_right.json
nano ~/.cache/huggingface/lerobot/calibration/robots/sourccey_z_actuator/sourccey_z_actuator.json
```

## Hosting the Robot

On the Raspberry Pi, start the robot host to enable remote control

```
uv run -m lerobot.robots.sourccey.sourccey.sourccey.sourccey_host
```

## Teleoperation

On your computer, activate the virtual environment and start teleoperation:

```

# On Linux/Mac
.venv/bin/acti vate


# On Windows
source .venv/Scripts/activate
```

# On Windows Then run:

```
python src/lerobot/control/sourccey/sourccey/teleoperate.py \
 --id="sourccey" \
 --remote_ip="192.168.1.214" \
 --left_arm_port="/dev/ttyACM1" \
 --right_arm_port="/dev/ttyACM0" \
 --keyboard_port="keyboard" \
 --fps=30 \
 --reverse=True
```

Add this if the wheel motors are reversed

```
--reverse=True
```

**Parameters:**

-   `--remote_ip`: IP address of the Raspberry Pi running the host
-   `--left_arm_port`: Serial port for left teleoperator arm (Windows: `COM3`, Linux: `/dev/ttyUSB0`)
-   `--right_arm_port`: Serial port for right teleoperator arm
-   `--fps`: Control loop frequency (default: 30)

## Recording Data

Record demonstration data for training:

```
python src/lerobot/control/sourccey/sourccey/record.py \
 --id="sourccey" \
 --remote_ip="192.168.1.214" \
 --left_arm_port="/dev/ttyACM1" \
 --right_arm_port="/dev/ttyACM0" \
 --reverse=True \
 --dataset.repo_id="sourccey-012/sourccey-012__shorts-fold-c__set019__mylesr" \
 --dataset.num_episodes=5 \
 --dataset.episode_time_s=200 \
 --dataset.reset_time_s=5 \
 --dataset.task="Fold the shorts" \
 --dataset.fps=30 \
 --dataset.push_to_hub=false
```

**Key Parameters:**

-   `--dataset.repo_id`: Dataset identifier (use `local/` prefix for local storage)
-   `--dataset.num_episodes`: Number of episodes to record
-   `--dataset.episode_time_s`: Duration of each episode in seconds
-   `--dataset.reset_time_s`: Time between episodes for reset
-   `--dataset.task`: Task description for the dataset

---

## Training Models

Train an ACT policy on your recorded dataset:

### Single GPU Training

```
python src/lerobot/scripts/lerobot_train.py \
 --dataset.repo_id=sourccey-009/sourccey-009__arm-left-a__set000__nick \
 --policy.type=act \
 --output_dir=outputs/train/act__sourccey-009__arm-left-a__set000__nick \
 --job_name=act__sourccey-009__arm-left-a__set000__nick \
 --policy.device=cuda \
 --wandb.enable=false \
 --steps=20000 \
 --save_freq=20000 \
 --policy.push_to_hub=false
```

```
python src/lerobot/scripts/lerobot_train.py \
  --dataset.repo_id=sourccey-012/combine/jeans/0006/sourccey-012__jeans-fold-2__cmb__0002__chrism \
  --policy.path="lerobot/xvla-base" \
  --output_dir=outputs/train/xvla__sourccey-012__jeans-fold__cmb__0006__chrism \
  --job_name=xvla__sourccey-012__jeans-fold__cmb__0006__chrism \
  --policy.device=cuda \
  --policy.train_soft_prompts=true \
  --policy.dtype=float32 \
  --policy.action_mode=auto \
  --policy.max_action_dim=20 \
  --policy.freeze_vision_encoder=false \
  --policy.freeze_language_encoder=false \
  --policy.train_policy_transformer=true \
  --policy.input_features=null \
  --policy.num_image_views=4 \
  --policy.empty_cameras=0 \
  --policy.push_to_hub=false \
  --wandb.enable=false \
  --steps=500000 \
  --save_freq=20000 \
  --policy.push_to_hub=false \
  --batch_size=4
  ```


### Multi-GPU Training

```
accelerate launch \
  --multi_gpu \
  --num_processes=2 \
  $(which lerobot-train) \
  --dataset.repo_id=sourccey-008/sourccey-008__counter-a__set000__name \
  --policy.type=act \
  --output_dir=outputs/train/act__sourccey-008__counter-a__set000__name \
  --job_name=act_multi_gpu \
  --steps=100000 \
  
  --save_freq=10000 \
  --batch_size=128 \
  --wandb.enable=false \
  --policy.push_to_hub=false
```

### Training on Pretrained Models

XVLA single-GPU training (use `--batch_size=4` to fit in 32GB VRAM):

```
CUDA_VISIBLE_DEVICES=0 python src/lerobot/scripts/lerobot_train.py \
  --dataset.repo_id=sourccey-012/sourccey-012__shorts-fold-c__cmb__000__mylesr \
  --policy.path="lerobot/xvla-base" \
  --output_dir=outputs/train/xvla__sourccey-012__shorts-fold-c__cmb__000__mylesr \
  --job_name=xvla__sourccey-012__shorts-fold-c__cmb__000__mylesr \
  --policy.device=cuda \
  --policy.input_features=null \
  --policy.num_image_views=4 \
  --policy.empty_cameras=0 \
  --wandb.enable=false \
  --steps=100000 \
  --save_freq=50000 \
  --policy.push_to_hub=false \
  --batch_size=4
```

### Resume command Single GPU Training
```
CUDA_VISIBLE_DEVICES=0 python src/lerobot/scripts/lerobot_train.py \
 --resume=true \
 --config_path=outputs/train/xvla__sourccey-009-012__shorts-fold__cmb__000__mylesr/checkpoints/last/pretrained_model/train_config_cleaned.json \
 --dataset.repo_id=sourccey-009-012__shorts-fold__cmb__001__mylesr \
 --output_dir=outputs/train/xvla__sourccey-009-012__shorts-fold__cmb__001__mylesr \
 --job_name=xvla__sourccey-009-012__shorts-fold__cmb__001__mylesr \
 --policy.device=cuda \
 --policy.dtype=float32 \
 --policy.action_mode=auto \
 --policy.max_action_dim=20 \
 --policy.input_features=null \
 --policy.num_image_views=4 \
 --policy.empty_cameras=0 \
 --policy.push_to_hub=false \
 --wandb.enable=false \
 --steps=200000 \
 --save_freq=50000 \
 --policy.push_to_hub=false \
 --batch_size=4
```

## Evaluation

Evaluate a trained model on the robot:

```
python src/lerobot/control/sourccey/sourccey/evaluate.py \
 --id="sourccey" \
 --remote_ip="192.168.1.214" \
 --model_path="outputs/train/xvla__sourccey-009-012__shorts-fold__cmb__000__mylesr/checkpoints/100000/pretrained_model" \
 --dataset.repo_id="sourccey-012/eval_sourccey-009-012__shorts-fold__cmb000__mylesr" \
 --dataset.num_episodes=1 \
 --dataset.episode_time_s=60 \
 --dataset.reset_time_s=5 \
 --dataset.task="Fold the shorts" \
 --dataset.fps=30

```

## Utilities

### Replay Recorded Data

Replay previously recorded episodes:

```
python src/lerobot/control/sourccey/sourccey/replay.py \
 --id="sourccey" \
 --remote_ip="192.168.1.166" \
 --dataset.dataset="sourccey-011/sourccey-011__set_table-a__set000__name" \
 --dataset.episode=0
 --dataset.fps=30
```

### Regenerating Protobuf Files

If you modify the protobuf definitions, regenerate the Python files:

```

rm -rf src/lerobot/robots/sourccey/sourccey/protobuf/generated
uv run python src/lerobot/robots/sourccey/sourccey/protobuf/compile.py

```

### Combining Datasets

Combine multiple datasets into one:

```

python src/lerobot/scripts/sourccey/combine_datasets.py \
 --dataset_paths='[
"sourccey-012/sourccey-012__shorts-fold-b__set000__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set001__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set002__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set003__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set004__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set005__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set006__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set007__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set008__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set009__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set010__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set011__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set012__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set013__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set014__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set015__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set016__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set017__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set018__mylesr",
"sourccey-012/sourccey-012__shorts-fold-b__set019__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set010__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set011__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set012__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set013__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set014__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set015__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set016__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set017__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set018__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set019__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set020__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set021__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set022__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set023__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set024__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set025__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set026__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set027__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set028__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set029__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set030__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set031__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set032__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set033__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set034__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set035__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set036__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set037__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set038__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set039__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set040__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set041__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set042__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set043__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set044__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set045__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set046__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set047__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set048__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set049__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set050__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set051__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set052__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set053__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set054__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set055__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set056__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set057__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set058__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set059__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set060__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set061__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set062__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set063__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set064__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set065__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set066__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set067__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set068__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set069__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set070__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set071__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set072__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set073__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set074__mylesr",
"sourccey-012/sourccey-012__shorts-fold-a__set075__mylesr",
"sourccey-009/sourccey-009__shorts-fold-a__set000__mylesr",
"sourccey-009/sourccey-009__shorts-fold-a__set001__mylesr",
"sourccey-009/sourccey-009__shorts-fold-a__set002__mylesr",
"sourccey-009/sourccey-009__shorts-fold-a__set003__mylesr",
"sourccey-009/sourccey-009__shorts-fold-a__set004__mylesr",
"sourccey-009/sourccey-009__shorts-fold-a__set005__mylesr",
"sourccey-009/sourccey-009__shorts-fold-a__set006__mylesr",
"sourccey-009/sourccey-009__shorts-fold-a__set007__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set000__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set001__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set002__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set003__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set004__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set005__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set006__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set007__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set008__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set009__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set010__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set011__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set012__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set013__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set014__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set015__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set016__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set017__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set018__mylesr",
"sourccey-012/sourccey-012__shorts-fold-c__set019__mylesr"

]' \
 --output_path="sourccey-009-012__shorts-fold__cmb__001__mylesr"
```

## **⚠️ Important:** Do not include trailing commas in the `--dataset_paths` array, as this will cause errors.

## Workflow Summary

1. **Calibrate** robot and teleoperator arms
2. **Host** the robot on Raspberry Pi (`sourccey_host`)
3. **Teleoperate** from your computer to control the robot
4. **Record** demonstration data for your task
5. **Train** a policy on the recorded data
6. **Evaluate** the trained model on the robot

---

## Troubleshooting

### Port Issues

-   Use `python -m lerobot.find_port` to find available serial ports
-   Ensure udev rules are set up correctly on Linux
-   Check port permissions: `ls -l /dev/ttyUSB*` or `ls -l /dev/ttyACM*`

### Connection Issues

-   Verify the Raspberry Pi IP address with `ip addr` or `ifconfig`
-   Ensure both devices are on the same network
-   Check firewall settings if connection fails

### Calibration Issues

-   If calibration fails, try a hard reset with `--full_reset=True`
-   Manually edit calibration files if needed (see [Viewing/Editing Calibration Files](#viewingediting-calibration-files))

```

```
